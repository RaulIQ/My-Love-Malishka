<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–ª—è –º–æ–µ–π –ª—é–±–∏–º–æ–π ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #ff477e;
            --accent: #ff85a1;
            --bg: #ffeef2;
            --glass: rgba(255, 255, 255, 0.9);
            --shadow: 0 8px 32px 0 rgba(255, 71, 126, 0.2);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            position: relative;
            padding: 20px;
        }

        /* –ü–ª–∞–≤–∞—é—â–∏–µ —Å–µ—Ä–¥—Ü–∞ –Ω–∞ —Ñ–æ–Ω–µ */
        .bg-hearts {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .container {
            width: 90%;
            max-width: 500px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 30px;
            box-shadow: var(--shadow);
            text-align: center;
            position: relative;
            z-index: 10;
            transition: transform 0.3s ease, height 0.3s ease;
        }

        h1, h2 { color: var(--primary); margin-bottom: 20px; }
        p { color: #555; margin-bottom: 25px; font-size: 1.1rem; line-height: 1.5; }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            outline: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 71, 126, 0.4);
        }

        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 71, 126, 0.6); }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        /* –°–∫—Ä—ã—Ç—ã–µ —Å–µ–∫—Ü–∏–∏ */
        .step { display: none; opacity: 0; transition: opacity 0.5s ease; }
        .step.active { display: block; opacity: 1; }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loader-bar {
            width: 100%;
            height: 10px;
            background: #eee;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 20px;
        }
        .loader-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.1s linear;
        }

        /* –†—É–ª–µ—Ç–∫–∞ */
        .roulette-window {
            width: 100%;
            overflow: hidden;
            position: relative;
            margin: 20px 0;
            border-radius: 15px;
            background: #fff;
            padding: 10px 0;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ü–µ–Ω—Ç—Ä–∞ —Ä—É–ª–µ—Ç–∫–∏ */
        .roulette-indicator {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            transform: translateX(-50%);
            z-index: 10;
            box-shadow: 0 0 10px rgba(255, 71, 126, 0.5);
        }

        .roulette-indicator::before,
        .roulette-indicator::after {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
        }

        .roulette-indicator::before {
            top: -5px;
            border-bottom: 10px solid var(--primary);
        }

        .roulette-indicator::after {
            bottom: -5px;
            border-top: 10px solid var(--primary);
        }

        .roulette-track {
            display: flex;
            gap: 20px;
            padding: 0 20px;
            width: max-content;
            transform: translateX(0);
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –≥–ª—é–∫–∞ */
        .glitch {
            animation: glitchShake 0.5s ease-in-out infinite;
        }

        @keyframes glitchShake {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            10% { transform: translate(-5px, -5px) rotate(-1deg); }
            20% { transform: translate(5px, 5px) rotate(1deg); }
            30% { transform: translate(-5px, 5px) rotate(-1deg); }
            40% { transform: translate(5px, -5px) rotate(1deg); }
            50% { transform: translate(-5px, -5px) rotate(-1deg); }
            60% { transform: translate(5px, 5px) rotate(1deg); }
            70% { transform: translate(-5px, 5px) rotate(-1deg); }
            80% { transform: translate(5px, -5px) rotate(1deg); }
            90% { transform: translate(-5px, -5px) rotate(-1deg); }
        }

        .roulette-window.glitch {
            animation: containerGlitch 0.3s ease-in-out infinite;
        }

        @keyframes containerGlitch {
            0%, 100% { filter: hue-rotate(0deg) contrast(1); }
            25% { filter: hue-rotate(90deg) contrast(1.5); }
            50% { filter: hue-rotate(180deg) contrast(0.8); }
            75% { filter: hue-rotate(270deg) contrast(1.2); }
        }

        .error-message {
            color: #ff0000;
            font-weight: bold;
            font-size: 1.2rem;
            animation: errorBlink 0.5s ease-in-out infinite;
        }

        @keyframes errorBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .card {
            min-width: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: white;
            padding: 10px;
            border-radius: 12px;
            transition: all 0.3s ease;
            opacity: 0.6;
            transform: scale(0.9);
        }

        .card.highlight {
            opacity: 1;
            transform: scale(1.1);
            border: 2px solid var(--primary);
            box-shadow: 0 4px 15px rgba(255, 71, 126, 0.3);
            z-index: 2;
        }

        .card img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 8px;
            border: 3px solid #eee;
        }

        .card span {
            font-size: 0.85rem;
            font-weight: bold;
            color: #333;
        }

        /* –ö–Ω–æ–ø–∫–∏-–∑–∞—Ö–≤–∞—Ç—á–∏–∫–∏ */
        .floating-yes {
            position: fixed;
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            pointer-events: auto;
            cursor: pointer;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            z-index: 5;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }

        .floating-yes:hover {
            transform: scale(1.2) !important;
            box-shadow: 0 6px 20px rgba(255, 71, 126, 0.6);
        }

        .floating-yes:active {
            transform: scale(0.9) !important;
        }

        .floating-yes.clicked {
            animation: yesButtonClick 0.5s ease-out forwards;
        }

        @keyframes yesButtonClick {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5) rotate(360deg); }
            100% { transform: scale(0); opacity: 0; }
        }

        @keyframes popIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* –§–æ—Ç–æ —Ñ–∏–Ω–∞–ª */
        .final-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary);
            margin: 0 auto 20px;
            display: block;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        /* –°–ª–∞–π–¥–µ—Ä –¥–ª—è —É—Ä–æ–≤–Ω—è –ª—é–±–≤–∏ */
        .love-slider {
            width: 100%;
            margin: 20px 0;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(to right, #ffb3ba, var(--primary));
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(255, 71, 126, 0.5);
        }

        input[type="range"]::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(255, 71, 126, 0.5);
        }

        .love-value {
            font-size: 2rem;
            color: var(--primary);
            font-weight: bold;
            margin: 10px 0;
        }

        /* –ò–≥—Ä–∞ —Å —Å–µ—Ä–¥–µ—á–∫–∞–º–∏ */
        .heart-game {
            position: relative;
            height: 200px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }

        .falling-heart {
            position: absolute;
            font-size: 2rem;
            cursor: pointer;
            animation: fall linear;
            user-select: none;
            transition: transform 0.1s;
        }

        .falling-heart:hover {
            transform: scale(1.3);
        }

        @keyframes fall {
            from { top: -50px; }
            to { top: 100%; }
        }

        .score-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –≤—ã–±–æ—Ä–∞ */
        .choice-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .choice-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .choice-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 4px 20px rgba(255, 71, 126, 0.3);
        }

        .choice-card .emoji {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .choice-card .label {
            font-weight: bold;
            color: #333;
        }

        /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ö–õ–ò–ö–ê–ë–ï–õ–¨–ù–´–• –°–ï–†–î–ï–ß–ï–ö */
        .clickable-heart {
            position: fixed;
            font-size: 2.5rem;
            cursor: pointer;
            user-select: none;
            z-index: 100;
            animation: heartPulse 1s ease-in-out infinite, heartFloat 3s ease-in-out infinite;
            transition: all 0.2s ease;
            pointer-events: auto;
        }

        .clickable-heart:hover {
            transform: scale(1.4) rotate(15deg);
        }

        .clickable-heart:active {
            transform: scale(0.9);
        }

        @keyframes heartPulse {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        @keyframes heartFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .heart-collected {
            animation: heartCollect 0.5s ease-out forwards;
        }

        @keyframes heartCollect {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5) rotate(360deg); }
            100% { transform: scale(0); opacity: 0; }
        }

        .final-score {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: bold;
            margin: 20px 0;
            animation: scoreGlow 1s ease-in-out infinite;
        }

        @keyframes scoreGlow {
            0%, 100% { text-shadow: 0 0 10px rgba(255, 71, 126, 0.5); }
            50% { text-shadow: 0 0 20px rgba(255, 71, 126, 1); }
        }

        /* Progress bar */
        .progress-container {
            width: 100%;
            background: #eee;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--primary));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
    </style>
</head>
<body>

    <div class="bg-hearts" id="bg-hearts"></div>

    <div class="container">
        
        <div id="step-0" class="step active">
            <h1>–ü—Ä–∏–≤–µ—Ç, –ª—é–±–∏–º–∞—è! ‚ù§Ô∏è</h1>
            <p>–Ø –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –¥–ª—è —Ç–µ–±—è –∫–æ–µ-—á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ. –ì–æ—Ç–æ–≤–∞ –ø—Ä–æ–π—Ç–∏ –Ω–µ–±–æ–ª—å—à–æ–π —Ç–µ—Å—Ç –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –Ω–∞—à–∏—Ö –≤—Å–µ–ª–µ–Ω–Ω—ã—Ö?</p>
            <button class="btn btn-primary" onclick="nextStep(1)">–ö–æ–Ω–µ—á–Ω–æ –≥–æ—Ç–æ–≤–∞!</button>
        </div>

        <div id="step-1" class="step">
            <h2>–°–∏—Ç—É–∞—Ü–∏—è ‚Ññ1</h2>
            <p>–ü—Ä–µ–¥—Å—Ç–∞–≤—å: –ù–∞—à–µ –ø–µ—Ä–≤–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ. –Ø –Ω–µ—Ä–≤–Ω–∏—á–∞—é –∏ —Å–ª—É—á–∞–π–Ω–æ –æ–ø—Ä–æ–∫–∏–¥—ã–≤–∞—é –Ω–∞ —Ç–µ–±—è –±–æ–∫–∞–ª –≤–∏–Ω–∞. –¢–≤–æ—è —Ä–µ–∞–∫—Ü–∏—è?</p>
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button class="btn btn-primary" onclick="nextStep(2)">–ü–æ—Å–º–µ—è—Ç—å—Å—è –∏ —Å–∫–∞–∑–∞—Ç—å "–ù–∞ —Å—á–∞—Å—Ç—å–µ!"</button>
                <button class="btn btn-secondary" id="runaway-btn-1" onmouseover="moveButton(this)">–£–π—Ç–∏ –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –º–µ–Ω—è</button>
            </div>
        </div>

        <div id="step-2" class="step">
            <h2>–°–∏—Ç—É–∞—Ü–∏—è ‚Ññ2</h2>
            <p>–í—ã—Ö–æ–¥–Ω–æ–π –¥–µ–Ω—å. –Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–∏–ª—å–º, –∫–æ—Ç–æ—Ä—ã–π —Ç–µ–±–µ –≤–æ–æ–±—â–µ –Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–µ–Ω. –ß—Ç–æ –¥–µ–ª–∞–µ–º?</p>
            <button class="btn btn-primary" onclick="nextStep(3)">–°–º–æ—Ç—Ä–∏–º, –Ω–æ —Ç—ã –∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—à—å –∫–∞–∂–¥—É—é —Å—Ü–µ–Ω—É</button>
            <button class="btn btn-secondary" onclick="fakeGlitch()">–í—ã–±–∏—Ä–∞–µ–º –¥—Ä—É–≥–æ–π (–ö–Ω–æ–ø–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)</button>
        </div>

        <div id="step-3" class="step">
            <h2>–°–∏—Ç—É–∞—Ü–∏—è ‚Ññ3</h2>
            <p>–ù–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ —Ç—ã –º–µ–Ω—è –ª—é–±–∏—à—å? –ü–æ–¥–≤–∏–Ω—å –ø–æ–ª–∑—É–Ω–æ–∫!</p>
            <div class="love-slider">
                <input type="range" id="love-range" min="0" max="100" value="50" oninput="updateLove(this.value)">
                <div class="love-value" id="love-display">50%</div>
                <p id="love-text" style="font-size: 0.9rem; color: #888;">–ù–µ–ø–ª–æ—Ö–æ...</p>
            </div>
            <button class="btn btn-primary" onclick="checkLove()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å!</button>
        </div>

        <div id="step-4" class="step">
            <h2>–ú–∏–Ω–∏-–∏–≥—Ä–∞! ‚ù§Ô∏è</h2>
            <p>–ü–æ–π–º–∞–π 5 —Å–µ—Ä–¥–µ—á–µ–∫ –∑–∞ 10 —Å–µ–∫—É–Ω–¥!</p>
            <div class="score-display">–ü–æ–π–º–∞–Ω–æ: <span id="heart-score">0</span>/5</div>
            <div class="score-display">–í—Ä–µ–º—è: <span id="heart-timer">10</span>—Å</div>
            <div class="heart-game" id="heart-game"></div>
        </div>

        <div id="step-5" class="step">
            <h2>–í–∞–∂–Ω—ã–π –≤—ã–±–æ—Ä!</h2>
            <p>–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å–≤–∏–¥–∞–Ω–∏—è —Ç–µ–±–µ –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è?</p>
            <div class="choice-cards">
                <div class="choice-card" onclick="nextStep(6)">
                    <div class="emoji">üåÉ</div>
                    <div class="label">–ù–æ—á–Ω–∞—è –ø—Ä–æ–≥—É–ª–∫–∞</div>
                </div>
                <div class="choice-card" onclick="nextStep(6)">
                    <div class="emoji">‚òï</div>
                    <div class="label">–£—é—Ç–Ω–æ–µ –∫–∞—Ñ–µ</div>
                </div>
                <div class="choice-card" onclick="nextStep(6)">
                    <div class="emoji">üé¨</div>
                    <div class="label">–ö–∏–Ω–æ</div>
                </div>
                <div class="choice-card" onclick="nextStep(6)">
                    <div class="emoji">üè°</div>
                    <div class="label">–î–æ–º–∞ –≤–º–µ—Å—Ç–µ</div>
                </div>
            </div>
        </div>

        <div id="step-6" class="step">
            <h2>–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –æ—Ç–≤–µ—Ç—ã...</h2>
            <p id="analysis-text">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
            <div class="loader-bar">
                <div class="loader-fill" id="loader"></div>
            </div>
        </div>

        <div id="step-7" class="step">
            <h2>–ü–æ–∏—Å–∫ –∏–¥–µ–∞–ª—å–Ω–æ–π –ø–∞—Ä—ã</h2>
            <p>–°–∫–∞–π–Ω–µ—Ç –ø–æ–¥–±–∏—Ä–∞–µ—Ç –ª—É—á—à–µ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –¥–ª—è —Ç–µ–±—è...</p>
            
            <div class="roulette-window">
                <div class="roulette-indicator"></div>
                <div class="roulette-track" id="track"></div>
            </div>
            <p id="roulette-status" style="margin-top:10px; font-size: 0.9rem; color: #888;">–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...</p>
        </div>

        <div id="step-8" class="step">
            <img src="https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=200&h=200" alt="Me" class="final-photo" id="my-photo">
            
            <h1>–≠—Ç–æ —è!</h1>
            <p>–í—Å–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–æ—à–ª–∏—Å—å. –ú—ã ‚Äî –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –≤–æ –≤—Å–µ—Ö –≤—Å–µ–ª–µ–Ω–Ω—ã—Ö.</p>
            <p style="font-weight: bold; font-size: 1.2rem;">–¢—ã –±—É–¥–µ—à—å –º–æ–µ–π –í–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π?</p>
            
            <div style="position: relative; z-index: 20;">
                <button class="btn btn-primary" id="final-yes" onclick="startHeartCollection()">–î–ê! ‚ù§Ô∏è</button>
                <button class="btn btn-secondary" id="final-no" onmouseover="spawnYesButtons()">–ù–µ—Ç...</button>
            </div>
        </div>
        
        <div id="step-9" class="step">
            <h1>–°–æ–±–µ—Ä–∏ –≤—Å–µ —Å–µ—Ä–¥–µ—á–∫–∏! ‚ù§Ô∏è</h1>
            <p>–ö–ª–∏–∫–∞–π –Ω–∞ —Å–µ—Ä–¥–µ—á–∫–∏, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ—é –ª—é–±–æ–≤—å!</p>
            <div class="final-score">–°–æ–±—Ä–∞–Ω–æ: <span id="collected-count">0</span>/30</div>
            <div class="progress-container">
                <div class="progress-fill" id="heart-progress"></div>
            </div>
            <p style="font-size: 0.9rem; color: #888; margin-top: 10px;">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –°–µ—Ä–¥–µ—á–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ!</p>
        </div>

        <div id="step-10" class="step">
            <h1>–£—Ä–∞! ‚ù§Ô∏è</h1>
            <p>–Ø —Ç–µ–±—è –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –ª—é–±–ª—é!</p>
            <p>–° –î–Ω–µ–º –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞!</p>
            <div style="font-size: 3rem;">üíë</div>
        </div>

    </div>

    <script>
        // --- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ---
        const myPhotoURL = "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=200&h=200"; 
        const myName = "–¢–≤–æ–π –õ—é–±–∏–º—ã–π";

        const randomPeople = [
            { name: "–ë—Ä—ç–¥ –ü–∏—Ç—Ç", img: "https://randomuser.me/api/portraits/men/32.jpg" },
            { name: "–ò–ª–æ–Ω –ú–∞—Å–∫", img: "https://randomuser.me/api/portraits/men/44.jpg" },
            { name: "–°–æ—Å–µ–¥ –í–∞—Å—è", img: "https://randomuser.me/api/portraits/men/85.jpg" },
            { name: "–ö—Ç–æ-—Ç–æ —Å –¢–∏–∫–¢–æ–∫–∞", img: "https://randomuser.me/api/portraits/men/22.jpg" },
            { name: "–°—É–ø–µ—Ä–º–µ–Ω", img: "https://randomuser.me/api/portraits/men/5.jpg" },
            { name: "–ú–∏–ª–ª–∏–æ–Ω–µ—Ä", img: "https://randomuser.me/api/portraits/men/11.jpg" },
        ];

        let currentStep = 0;

        // --- –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ ---
        function nextStep(stepNum) {
            currentStep = stepNum;
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById('step-' + stepNum).classList.add('active');

            if (stepNum === 4) startHeartCatchGame();
            if (stepNum === 6) startAnalysis();
            if (stepNum === 7) startRoulette();
            if (stepNum === 8) document.getElementById('my-photo').src = myPhotoURL;
        }

        // --- –£–±–µ–≥–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ ---
        function moveButton(btn) {
            if (window.innerWidth < 600) {
                btn.innerText = "–≠—Ç–æ –Ω–µ –≤–∞—Ä–∏–∞–Ω—Ç)";
                btn.style.background = "#ccc";
                btn.style.borderColor = "#ccc";
                return;
            }

            // –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–Ω–æ–ø–∫–∏
            const btnRect = btn.getBoundingClientRect();
            const btnWidth = btnRect.width;
            const btnHeight = btnRect.height;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏
            const margin = 20;
            const maxX = window.innerWidth - btnWidth - margin;
            const maxY = window.innerHeight - btnHeight - margin;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü
            const x = margin + Math.random() * (maxX - margin);
            const y = margin + Math.random() * (maxY - margin);

            btn.style.position = 'fixed';
            btn.style.left = x + 'px';
            btn.style.top = y + 'px';
            btn.style.zIndex = '1000';
        }

        // --- –§–µ–π–∫–æ–≤—ã–π –ì–ª–∏—Ç—á ---
        function fakeGlitch() {
            alert("–û—à–∏–±–∫–∞ 404: –î—Ä—É–≥–∏–µ —Ñ–∏–ª—å–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –≤—ã–±—Ä–∞–ª–∞ –≤–∞—Ä–∏–∞–Ω—Ç: –°–º–æ—Ç—Ä–µ—Ç—å —Ç–æ, —á—Ç–æ —Ö–æ—á–µ—à—å —Ç—ã.");
            nextStep(3);
        }

        // --- –°–ª–∞–π–¥–µ—Ä –ª—é–±–≤–∏ ---
        function updateLove(value) {
            const display = document.getElementById('love-display');
            const text = document.getElementById('love-text');
            display.textContent = value + '%';
            
            if (value < 30) {
                text.textContent = "–°–µ—Ä—å–µ–∑–Ω–æ? ü•∫";
                text.style.color = "#888";
            } else if (value < 70) {
                text.textContent = "–ú–æ–∂–Ω–æ –±–æ–ª—å—à–µ! üòä";
                text.style.color = "#ff85a1";
            } else if (value < 99) {
                text.textContent = "–í–æ—Ç —ç—Ç–æ –ª—é–±–æ–≤—å! ‚ù§Ô∏è";
                text.style.color = "var(--primary)";
            } else {
                text.textContent = "–ò–î–ï–ê–õ–¨–ù–û! üíï";
                text.style.color = "var(--primary)";
                text.style.fontWeight = "bold";
            }
        }

        function checkLove() {
            const value = document.getElementById('love-range').value;
            if (value < 100) {
                alert("–£–ø—Å! –ü–æ–ª–∑—É–Ω–æ–∫ —Å–∞–º –ø–æ–¥–≤–∏–Ω—É–ª—Å—è –¥–æ 100% üòâ");
                document.getElementById('love-range').value = 100;
                updateLove(100);
                setTimeout(() => nextStep(4), 1000);
            } else {
                nextStep(4);
            }
        }

        // --- –ú–∏–Ω–∏-–∏–≥—Ä–∞ –ª–æ–≤–∏—Ç—å —Å–µ—Ä–¥–µ—á–∫–∏ ---
        let heartsCaught = 0;
        let gameTime = 10;
        let gameInterval;
        let spawnInterval;

        function startHeartCatchGame() {
            heartsCaught = 0;
            gameTime = 10;
            document.getElementById('heart-score').textContent = heartsCaught;
            document.getElementById('heart-timer').textContent = gameTime;
            
            const gameArea = document.getElementById('heart-game');
            gameArea.innerHTML = '';

            // –¢–∞–π–º–µ—Ä
            gameInterval = setInterval(() => {
                gameTime--;
                document.getElementById('heart-timer').textContent = gameTime;
                
                if (gameTime <= 0 || heartsCaught >= 5) {
                    clearInterval(gameInterval);
                    clearInterval(spawnInterval);
                    
                    if (heartsCaught >= 5) {
                        setTimeout(() => {
                            alert("–û—Ç–ª–∏—á–Ω–æ! –¢—ã –ø–æ–π–º–∞–ª–∞ –≤—Å–µ —Å–µ—Ä–¥–µ—á–∫–∏! ‚ù§Ô∏è");
                            nextStep(5);
                        }, 500);
                    } else {
                        alert("–ù–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ! –ì–ª–∞–≤–Ω–æ–µ - —Ç—ã —Å—Ç–∞—Ä–∞–ª–∞—Å—å üòä");
                        nextStep(5);
                    }
                }
            }, 1000);

            // –°–ø–∞–≤–Ω —Å–µ—Ä–¥–µ—á–µ–∫
            spawnInterval = setInterval(() => {
                if (heartsCaught < 5) {
                    createFallingHeart();
                }
            }, 800);
        }

        function createFallingHeart() {
            const gameArea = document.getElementById('heart-game');
            const heart = document.createElement('div');
            heart.className = 'falling-heart';
            heart.textContent = '‚ù§Ô∏è';
            heart.style.left = Math.random() * (gameArea.offsetWidth - 40) + 'px';
            heart.style.animationDuration = (2 + Math.random() * 2) + 's';
            
            heart.onclick = () => {
                if (heartsCaught < 5) {
                    heartsCaught++;
                    document.getElementById('heart-score').textContent = heartsCaught;
                    heart.remove();
                }
            };
            
            gameArea.appendChild(heart);
            
            setTimeout(() => {
                if (heart.parentNode) heart.remove();
            }, 4000);
        }

        // --- –ê–Ω–∞–ª–∏–∑ ---
        function startAnalysis() {
            const texts = ["–°—á–∏—Ç—ã–≤–∞–Ω–∏–µ –∫–∞—Ä–º—ã...", "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏...", "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—à–ª—ã—Ö –∂–∏–∑–Ω–µ–π...", "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–¥–µ—Ü...", "–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ..."];
            const textEl = document.getElementById('analysis-text');
            const loader = document.getElementById('loader');
            let progress = 0;
            
            let interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                loader.style.width = progress + "%";
                
                if (Math.random() > 0.7) {
                    textEl.innerText = texts[Math.floor(Math.random() * texts.length)];
                }

                if (progress === 100) {
                    clearInterval(interval);
                    setTimeout(() => nextStep(7), 500);
                }
            }, 300);
        }

        // --- –†—É–ª–µ—Ç–∫–∞ ---
        function startRoulette() {
            const track = document.getElementById('track');
            const rouletteWindow = track.parentElement;
            const statusText = document.getElementById('roulette-status');
            track.innerHTML = '';
            track.style.transform = 'translateX(0px)';
            if (track.getAnimations) track.getAnimations().forEach(a => a.cancel());
            
            let cardsHTML = '';
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
            for(let i=0; i<15; i++) {
                let p = randomPeople[i % randomPeople.length];
                cardsHTML += createCard(p.name, p.img);
            }
            
            // –ú–û–Ø –ö–ê–†–¢–û–ß–ö–ê –Ω–∞ –∏–Ω–¥–µ–∫—Å–µ 15
            cardsHTML += createCard(myName, myPhotoURL, true);

            // –ï—â–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ—Å–ª–µ –º–µ–Ω—è
            for(let i=0; i<10; i++) {
                let p = randomPeople[i % randomPeople.length];
                cardsHTML += createCard(p.name, p.img);
            }

            track.innerHTML = cardsHTML;

            const myCardIndex = 15; // –ò–Ω–¥–µ–∫—Å –º–æ–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏
            const wrongCardIndex = 18; // –ò–Ω–¥–µ–∫—Å "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ" –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ (–ø—Ä–æ–ª–µ—Ç–∞–µ–º –º–∏–º–æ)
            const cards = track.querySelectorAll('.card');

            if (!cards[myCardIndex] || !cards[wrongCardIndex]) {
                statusText.innerText = "–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –∫–∞—Ä—Ç–æ—á–µ–∫";
                statusText.style.color = "#ff0000";
                return;
            }

            const calcPosition = (index) => {
                const card = cards[index];
                if (!card) return 0;

                // –°—á–∏—Ç–∞–µ–º –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º —Ä–∞–∑–º–µ—Ä–∞–º/–æ—Ç—Å—Ç—É–ø–∞–º, –∞ –Ω–µ "–º–∞–≥–∏—á–µ—Å–∫–∏–º" cardWidth/gap
                const cardCenter = card.offsetLeft + (card.offsetWidth / 2);
                const windowCenter = rouletteWindow.clientWidth / 2;
                return cardCenter - windowCenter;
            };
             
            // –≠–¢–ê–ü 1: –ü—Ä–æ–ª–µ—Ç–∞–µ–º –º–∏–º–æ –º–µ–Ω—è –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ –¥—Ä—É–≥–æ–º
            const wrongPosition = calcPosition(wrongCardIndex);
            
            statusText.innerText = "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...";
            statusText.style.color = "#888";
            
            const firstAnimation = track.animate([
                { transform: 'translateX(0px)' },
                { transform: `translateX(-${wrongPosition}px)` }
            ], {
                duration: 4000,
                easing: 'cubic-bezier(0.1, 0.9, 0.2, 1)',
                fill: 'forwards'
            });
            firstAnimation.onfinish = () => {
                track.style.transform = `translateX(-${wrongPosition}px)`;
            };

            // –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π" —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            setTimeout(() => {
                const allCards = track.querySelectorAll('.card');
                allCards[wrongCardIndex].classList.add('highlight');
                
                statusText.innerText = "–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ: 98%";
                statusText.style.color = "var(--primary)";
                statusText.style.fontWeight = "bold";
                
                // –≠–¢–ê–ü 2: –ß–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≥–ª—é–∫
                setTimeout(() => {
                    statusText.innerHTML = "<span class='error-message'>‚ö†Ô∏è –û–®–ò–ë–ö–ê –°–ò–°–¢–ï–ú–´ ‚ö†Ô∏è</span>";
                    rouletteWindow.classList.add('glitch');
                    track.classList.add('glitch');
                    
                    // –ó–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç —á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç
                    let glitchCount = 0;
                    const glitchMessages = [
                        "–°–ò–°–¢–ï–ú–ù–ê–Ø –û–®–ò–ë–ö–ê...",
                        "–ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê...",
                        "–ü–ï–†–ï–°–ß–ï–¢ –ê–õ–ì–û–†–ò–¢–ú–ê...",
                        "–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–•..."
                    ];
                    
                    const glitchInterval = setInterval(() => {
                        statusText.innerHTML = `<span class='error-message'>${glitchMessages[glitchCount % glitchMessages.length]}</span>`;
                        glitchCount++;
                    }, 400);
                    
                    // –≠–¢–ê–ü 3: –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –≥–ª—é–∫–∞ - –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –º–µ–Ω—è
                    setTimeout(() => {
                        clearInterval(glitchInterval);
                        rouletteWindow.classList.remove('glitch');
                        track.classList.remove('glitch');
                        allCards[wrongCardIndex].classList.remove('highlight');
                        
                        // –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è - –º–æ—è –∫–∞—Ä—Ç–æ—á–∫–∞
                        const correctPosition = calcPosition(myCardIndex);
                        
                        statusText.innerText = "–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...";
                        statusText.style.color = "#888";
                        
                        // –ê–Ω–∏–º–∞—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ
                        const fromTransform = (track.style.transform && track.style.transform !== 'none')
                            ? track.style.transform
                            : `translateX(-${wrongPosition}px)`;

                        const correctAnimation = track.animate([
                            { transform: fromTransform },
                            { transform: `translateX(-${correctPosition}px)` }
                        ], {
                            duration: 2000,
                            easing: 'cubic-bezier(0.34, 1.56, 0.64, 1)', // –≠—Ñ—Ñ–µ–∫—Ç "bounce"
                            fill: 'forwards'
                        });
                        correctAnimation.onfinish = () => {
                            track.style.transform = `translateX(-${correctPosition}px)`;
                        };
                        
                        // –ü–æ—Å–ª–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                        setTimeout(() => {
                            document.getElementById('winner-card').classList.add('highlight');
                            statusText.innerText = "‚úì –ò–°–¢–ò–ù–ù–û–ï –°–û–í–ü–ê–î–ï–ù–ò–ï: 100%";
                            statusText.style.color = "var(--primary)";
                            statusText.style.fontWeight = "bold";
                            statusText.style.fontSize = "1.1rem";
                            
                            setTimeout(() => nextStep(8), 2500);
                        }, 2000);
                        
                    }, 2000); // 2 —Å–µ–∫—É–Ω–¥—ã –≥–ª—é–∫–∞
                    
                }, 1500); // –ü–∞—É–∑–∞ –ø–æ—Å–ª–µ "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ" —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                
            }, 4000); // –í—Ä–µ–º—è –ø–µ—Ä–≤–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
        }

        function createCard(name, img, isMe = false) {
            const idAttr = isMe ? 'id="winner-card"' : '';
            return `
                <div class="card" ${idAttr}>
                    <img src="${img}" alt="${name}">
                    <span>${name}</span>
                </div>
            `;
        }

        // --- –ù–∞—à–µ—Å—Ç–≤–∏–µ –∫–Ω–æ–ø–æ–∫ –î–ê ---
        function spawnYesButtons() {
            const container = document.body;
            const btnNo = document.getElementById('final-no');
            
            btnNo.style.opacity = '0';
            btnNo.style.pointerEvents = 'none';

            let count = 0;
            const maxButtons = 500;
            
            const spawner = setInterval(() => {
                if(count >= maxButtons) {
                    clearInterval(spawner);
                    return;
                }
                
                const btn = document.createElement('div');
                btn.className = 'floating-yes';
                btn.innerText = "–î–ê!";
                
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;

                btn.style.left = x + 'px';
                btn.style.top = y + 'px';
                
                const scale = 0.6 + Math.random() * 0.8;
                const rotate = (Math.random() - 0.5) * 30;
                btn.style.transform = `scale(${scale}) rotate(${rotate}deg)`;
                
                btn.style.opacity = 0.8 + Math.random() * 0.2;

                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                btn.onclick = function() {
                    this.classList.add('clicked');
                    setTimeout(() => {
                        this.remove();
                    }, 500);
                };

                container.appendChild(btn);
                count++;
            }, 15); // –ï—â–µ –±—ã—Å—Ç—Ä–µ–µ - 15–º—Å
        }

        // --- –ù–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê –ö–õ–ò–ö–ê–ë–ï–õ–¨–ù–´–• –°–ï–†–î–ï–ß–ï–ö ---
        let collectedHearts = 0;
        const totalHearts = 30;
        let heartSpawnInterval;
        let activeHearts = [];

        function startHeartCollection() {
            nextStep(9);
            collectedHearts = 0;
            activeHearts = [];
            updateHeartProgress();
            
            // –°–æ–∑–¥–∞–µ–º —Å–µ—Ä–¥–µ—á–∫–∏ —á–∞—â–µ –∏ –±–æ–ª—å—à–µ
            heartSpawnInterval = setInterval(() => {
                if (collectedHearts < totalHearts && activeHearts.length < 15) {
                    createClickableHeart();
                }
            }, 400); // –ö–∞–∂–¥—ã–µ 400–º—Å –Ω–æ–≤–æ–µ —Å–µ—Ä–¥–µ—á–∫–æ
            
            // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–¥–µ—á–µ–∫
            for(let i = 0; i < 8; i++) {
                setTimeout(() => createClickableHeart(), i * 200);
            }
        }

        function createClickableHeart() {
            const heart = document.createElement('div');
            heart.className = 'clickable-heart';
            heart.textContent = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíì', 'üíù'][Math.floor(Math.random() * 6)];
            
            // –†–∞–∑–º–µ—â–∞–µ–º —Å–µ—Ä–¥–µ—á–∫–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏
            const margin = 50;
            const maxX = window.innerWidth - margin;
            const maxY = window.innerHeight - margin;
            
            heart.style.left = (margin + Math.random() * (maxX - margin * 2)) + 'px';
            heart.style.top = (margin + Math.random() * (maxY - margin * 2)) + 'px';
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
            const size = 1.5 + Math.random() * 1.5;
            heart.style.fontSize = size + 'rem';
            
            heart.onclick = function() {
                if (collectedHearts < totalHearts) {
                    collectedHearts++;
                    updateHeartProgress();
                    
                    // –ê–Ω–∏–º–∞—Ü–∏—è —Å–±–æ—Ä–∞
                    heart.classList.add('heart-collected');
                    
                    // –£–¥–∞–ª—è–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö
                    const index = activeHearts.indexOf(heart);
                    if (index > -1) {
                        activeHearts.splice(index, 1);
                    }
                    
                    setTimeout(() => {
                        heart.remove();
                    }, 500);
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
                    if (collectedHearts >= totalHearts) {
                        clearInterval(heartSpawnInterval);
                        setTimeout(() => {
                            // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Å–µ—Ä–¥–µ—á–∫–∏
                            activeHearts.forEach(h => h.remove());
                            activeHearts = [];
                            finish();
                        }, 1000);
                    }
                }
            };
            
            document.body.appendChild(heart);
            activeHearts.push(heart);
            
            // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –¥–≤–∏–≥–∞–µ–º —Å–µ—Ä–¥–µ—á–∫–∏, —á—Ç–æ–±—ã –æ–Ω–∏ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ
            const moveInterval = setInterval(() => {
                if (!heart.parentNode) {
                    clearInterval(moveInterval);
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã—à–ª–æ –ª–∏ —Å–µ—Ä–¥–µ—á–∫–æ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã
                const rect = heart.getBoundingClientRect();
                if (rect.left < 0 || rect.right > window.innerWidth || 
                    rect.top < 0 || rect.bottom > window.innerHeight) {
                    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞ —ç–∫—Ä–∞–Ω
                    const newX = margin + Math.random() * (maxX - margin * 2);
                    const newY = margin + Math.random() * (maxY - margin * 2);
                    heart.style.left = newX + 'px';
                    heart.style.top = newY + 'px';
                }
            }, 3000);
        }

        function updateHeartProgress() {
            document.getElementById('collected-count').textContent = collectedHearts;
            const progress = (collectedHearts / totalHearts) * 100;
            document.getElementById('heart-progress').style.width = progress + '%';
        }

        function finish() {
            nextStep(10);
            // –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
            for(let i=0; i<50; i++) {
                setTimeout(() => createConfettiHeart(), i * 100);
            }
        }

        // --- –§–æ–Ω–æ–≤—ã–µ —Å–µ—Ä–¥–µ—á–∫–∏ (–∫–æ–Ω—Ñ–µ—Ç—Ç–∏) ---
        function createConfettiHeart() {
            const heart = document.createElement('div');
            heart.innerHTML = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó'][Math.floor(Math.random() * 4)];
            heart.style.position = 'fixed';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.top = '-50px';
            heart.style.fontSize = (Math.random() * 30 + 20) + 'px';
            heart.style.opacity = Math.random() * 0.7 + 0.3;
            heart.style.pointerEvents = 'none';
            heart.style.zIndex = '1';
            
            const duration = Math.random() * 3 + 2;
            const drift = (Math.random() - 0.5) * 200;
            
            heart.style.transition = `all ${duration}s linear`;
            
            document.getElementById('bg-hearts').appendChild(heart);
            
            setTimeout(() => {
                heart.style.top = '110vh';
                heart.style.transform = `translateX(${drift}px) rotate(${Math.random() * 360}deg)`;
            }, 100);

            setTimeout(() => {
                heart.remove();
            }, (duration + 1) * 1000);
        }

        // –§–æ–Ω–æ–≤—ã–µ —Å–µ—Ä–¥–µ—á–∫–∏
        function createBgHeart() {
            const heart = document.createElement('div');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.position = 'fixed';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.top = '110vh';
            heart.style.fontSize = (Math.random() * 20 + 10) + 'px';
            heart.style.opacity = Math.random() * 0.3 + 0.1;
            heart.style.pointerEvents = 'none';
            heart.style.zIndex = '1';
            heart.style.transition = `top ${Math.random() * 4 + 3}s linear`;
            
            document.getElementById('bg-hearts').appendChild(heart);
            
            setTimeout(() => {
                heart.style.top = '-50px';
            }, 100);

            setTimeout(() => {
                heart.remove();
            }, 7000);
        }

        // –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤—ã—Ö —Å–µ—Ä–¥–µ—Ü
        setInterval(createBgHeart, 1200);
    </script>
</body>
</html>
